---
id: custom
title: Собственная авторизация
sidebar_position: 1
---
import CustomAuthScheme from '/img/integrations-auth-custom-1.png';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Для разработки собственной авторизации необходимо понимание процесса авторизации,
ниже представлен процесс от входа лаунчера, до ответа на вашем сайте

## Как работает авторизация?

1. Пользователь вводит логин и пароль в лаунчере
2. Лаунчер отправляет запрос на ваш сервер авторизации
3. Сервер проверяет учетные данные и отправляет ответ
4. Лаунчер обрабатывает ответ и предоставляет или отказывает в доступе

<p><img className="image-zoom-medium" src={CustomAuthScheme} alt=""/></p>

На фото представлены 4 этапа отправки уведомления. Вот описание всех 4:

1. Запрос от лаунчера к Gml.Backend

<Tabs>
    <TabItem value="curl" label="Curl" default>

        ```curl
        curl
        --location 'http://localhost:5003/api/v1/integrations/auth/signin' \
        --header 'Content-Type: application/json' \
        --data '{
        "Login": "ЛОГИН",
        "Password": "ПАРОЛЬ",
        "2FACode": "КОД_2FA"
    }'
        ```
    </TabItem>
    <TabItem value="javascript" label="JavaScript">
        ```
        const myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
        const raw = JSON.stringify({
        "Login": "ЛОГИН",
        "Password": "ПАРОЛЬ",
        "2FACode": "КОД_2FA"
    });
        const requestOptions = {
        method: "POST",
        headers: myHeaders,
        body: raw,
        redirect: "follow"
    };
        fetch("http://localhost:5003/api/v1/integrations/auth/signin", requestOptions)
        .then((response) => response.text())
        .then((result) => console.log(result))
        .catch((error) => console.error(error));
        ```
    </TabItem>
</Tabs>

2. Gml.Backend - Ваш сайт

<Tabs>
    <TabItem value="curl" label="Curl" default>
        ```curl
        curl --location 'http://ВАШ_АДРЕС' \
        --header 'Content-Type: application/json' \
        --data '{
        "Login": "ЛОГИН",
        "Password": "ПАРОЛЬ",
        "Totp": "КОД_2FA"
    }'
        ```
    </TabItem>
    <TabItem value="javascript" label="JavaScript">
        ```javascript
        const myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
        const raw = JSON.stringify({
        "Login": "ЛОГИН",
        "Password": "ПАРОЛЬ",
        "Totp": "КОД_2FA"
    });
        const requestOptions = {
        method: "POST",
        headers: myHeaders,
        body: raw,
        redirect: "follow"
    };
        fetch("http://ВАШ_АДРЕС", requestOptions)
        .then((response) => response.text())
        .then((result) => console.log(result))
        .catch((error) => console.error(error));
        ```
    </TabItem>
    <TabItem value="response" label="Пример вашего ответа">
        `200` - Успешная авторизация *
        ```json
        {
            "Login": "GamerVII",
            "UserUuid": "c07a9841-2275-4ba0-8f1c-2e1599a1f22f",
            "IsSlim": true,
            "Message": "Успешная авторизация"
        }
        ```

        `401` - Ошибка аутентификации *
        ```json
        {
            "Message": "Неверный логин или пароль"
        }
        ```

        `401` - Ошибка аутентификации, нужен ввод 2FA **
        ```json
        {
            "Message": "Введите проверочный код 2FA"
        }
        ```

        `404` - Пользователь не найден
        ```json
        {
            "Message": "Пользователь не найден"
        }
        ```

        `403` - Пользователь не имеет доступа или заблокирован
        ```json
        {
            "Message": "Пользователь заблокирован. Причина: Раздача на спавне"
        }
        ```

        \* Обратите внимание, что не обязательно заполнять тело ответа, достаточно вернуть StatusCode (Обязательно)
        Поля `Message` и `UserUuid` будут сгенерированы автоматически.

        Ендпоинты **200** и **401** необходимо реализовать ***Обязательно***

        ** В случае, если вы хотите проверять коды двухфакторной атентификации наличие сообщения "Введите проверочный
        код 2FA" — ***Обязательно***
    </TabItem>
</Tabs>

### Собственная авторизация

Есть возможность реализовать свою, кастомную авторизацию через Endpoint.
Для этого нужно на стороне вашего сервиса реализовать [Endpoint](https://en.wikipedia.org/wiki/Web_API#Endpoints)

1. Выберите в панель управление раздел:
`Интеграции` -> `Аутентификация` -> `Аутентификация` -> `Собственная аутентификация`
2. Вставьте ссылку на реализованный endoint авторизации `Gml.Backend - Ваш сайт`

> **Важно!** Примеры реализации можете посмотреть [на странице Github](https://github.com/GamerVII-NET/Gml.Modules.Auth)


